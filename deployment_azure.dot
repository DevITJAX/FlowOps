// Architecture de D√©ploiement Azure - FlowOps
// Compiler avec: dot -Tpng deployment_azure.dot -o deployment_azure.png
// Ou SVG:        dot -Tsvg deployment_azure.dot -o deployment_azure.svg

digraph DeploymentAzure {
    // ===========================================
    // CONFIGURATION G√âN√âRALE
    // ===========================================
    graph [
        rankdir=TB
        splines=ortho
        nodesep=1.0
        ranksep=0.8
        bgcolor="white"
        fontname="Helvetica Neue, Arial"
        pad="0.5"
        margin="0.2"
    ]
    
    node [
        fontname="Helvetica Neue, Arial"
        fontsize=11
    ]
    
    edge [
        fontname="Helvetica Neue, Arial"
        fontsize=10
        penwidth=2
    ]
    
    // ===========================================
    // TITRE
    // ===========================================
    labelloc=t
    label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0">
        <TR><TD><FONT POINT-SIZE="18" COLOR="#0078D4"><B>Architecture Cloud Azure</B></FONT></TD></TR>
        <TR><TD><FONT POINT-SIZE="11" COLOR="#666666">FlowOps - Pipeline de D√©ploiement</FONT></TD></TR>
    </TABLE>>
    
    // ===========================================
    // SOURCE CODE - GITHUB
    // ===========================================
    subgraph cluster_source {
        label=<<FONT POINT-SIZE="12" COLOR="#24292E"><B>üì¶ Source Code</B></FONT>>
        style="rounded,filled"
        fillcolor="#F6F8FA"
        color="#D0D7DE"
        margin="20"
        
        github [
            label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="4">
                <TR><TD><FONT POINT-SIZE="20">üêô</FONT></TD></TR>
                <TR><TD><B>GitHub Repository</B></TD></TR>
                <TR><TD><FONT POINT-SIZE="9" COLOR="#666666">Code source + Workflows</FONT></TD></TR>
            </TABLE>>
            shape=box
            style="rounded,filled"
            fillcolor="white"
            color="#24292E"
            penwidth=2
        ]
    }
    
    // ===========================================
    // CI/CD - GITHUB ACTIONS
    // ===========================================
    subgraph cluster_cicd {
        label=<<FONT POINT-SIZE="12" COLOR="#2088FF"><B>‚ö° CI/CD Pipeline</B></FONT>>
        style="rounded,filled"
        fillcolor="#EBF5FF"
        color="#2088FF"
        margin="20"
        
        actions [
            label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="4">
                <TR><TD><FONT POINT-SIZE="20">‚öôÔ∏è</FONT></TD></TR>
                <TR><TD><B>GitHub Actions</B></TD></TR>
                <TR><TD><FONT POINT-SIZE="9" COLOR="#666666">Build ‚Ä¢ Test ‚Ä¢ Deploy</FONT></TD></TR>
            </TABLE>>
            shape=box
            style="rounded,filled"
            fillcolor="white"
            color="#2088FF"
            penwidth=2
        ]
    }
    
    // ===========================================
    // AZURE CLOUD
    // ===========================================
    subgraph cluster_azure {
        label=<<FONT POINT-SIZE="14" COLOR="#0078D4"><B>‚òÅÔ∏è Microsoft Azure</B></FONT>>
        style="rounded,filled"
        fillcolor="#F0F9FF"
        color="#0078D4"
        margin="25"
        
        // Container Registry
        acr [
            label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="4">
                <TR><TD><FONT POINT-SIZE="20">üì¶</FONT></TD></TR>
                <TR><TD><B>Azure Container Registry</B></TD></TR>
                <TR><TD><FONT POINT-SIZE="9" COLOR="#666666">flowopsacr.azurecr.io</FONT></TD></TR>
            </TABLE>>
            shape=box
            style="rounded,filled"
            fillcolor="#E5F1FB"
            color="#0078D4"
            penwidth=2
        ]
        
        // App Services
        subgraph cluster_appservices {
            label=<<FONT POINT-SIZE="11" COLOR="#50E6FF"><B>üåê Azure App Services</B></FONT>>
            style="rounded,filled"
            fillcolor="white"
            color="#50E6FF"
            margin="15"
            
            backend [
                label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="2">
                    <TR><TD><FONT POINT-SIZE="16">üîß</FONT></TD></TR>
                    <TR><TD><B>Backend</B></TD></TR>
                    <TR><TD><FONT POINT-SIZE="8" COLOR="#666666">Node.js + Express</FONT></TD></TR>
                    <TR><TD><FONT POINT-SIZE="7" COLOR="#0078D4">flowops-backend.azurewebsites.net</FONT></TD></TR>
                </TABLE>>
                shape=box
                style="rounded,filled"
                fillcolor="#E8F5E9"
                color="#4CAF50"
                penwidth=2
            ]
            
            frontend [
                label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="2">
                    <TR><TD><FONT POINT-SIZE="16">üñ•Ô∏è</FONT></TD></TR>
                    <TR><TD><B>Frontend</B></TD></TR>
                    <TR><TD><FONT POINT-SIZE="8" COLOR="#666666">React + Vite + Nginx</FONT></TD></TR>
                    <TR><TD><FONT POINT-SIZE="7" COLOR="#0078D4">flowops-frontend.azurewebsites.net</FONT></TD></TR>
                </TABLE>>
                shape=box
                style="rounded,filled"
                fillcolor="#E3F2FD"
                color="#2196F3"
                penwidth=2
            ]
        }
        
        // Database
        cosmosdb [
            label=<<TABLE BORDER="0" CELLBORDER="0" CELLSPACING="4">
                <TR><TD><FONT POINT-SIZE="20">üóÑÔ∏è</FONT></TD></TR>
                <TR><TD><B>Azure Cosmos DB</B></TD></TR>
                <TR><TD><FONT POINT-SIZE="9" COLOR="#666666">MongoDB API</FONT></TD></TR>
            </TABLE>>
            shape=cylinder
            style="filled"
            fillcolor="#FFF3E0"
            color="#FF9800"
            penwidth=2
        ]
    }
    
    // ===========================================
    // CONNEXIONS
    // ===========================================
    
    // GitHub -> Actions
    github -> actions [
        label="  Push / PR  "
        color="#24292E"
        fontcolor="#24292E"
        style=bold
    ]
    
    // Actions -> ACR
    actions -> acr [
        label="  Build & Push Images  "
        color="#2088FF"
        fontcolor="#2088FF"
        style=bold
    ]
    
    // ACR -> Backend
    acr -> backend [
        label="  Pull  "
        color="#0078D4"
        fontcolor="#0078D4"
    ]
    
    // ACR -> Frontend
    acr -> frontend [
        label="  Pull  "
        color="#0078D4"
        fontcolor="#0078D4"
    ]
    
    // Backend <-> CosmosDB
    backend -> cosmosdb [
        label="  MongoDB Protocol  "
        color="#FF9800"
        fontcolor="#FF9800"
        dir=both
        style=dashed
    ]
    
    // Frontend -> Backend (API calls)
    frontend -> backend [
        label="  REST API  "
        color="#4CAF50"
        fontcolor="#4CAF50"
        style=dashed
        constraint=false
    ]
    
    // ===========================================
    // RANGS POUR ALIGNEMENT
    // ===========================================
    { rank=same; backend; frontend }
}

